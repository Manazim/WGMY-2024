# Question
My SOC detected there are Ransomware that decrypt file for fun. The script kiddies is so tricky. Here some evidence that we successfully retrieve.

# Tools
- Volatility
- Wireshark
- Pyintxtractor
- pylingual.io

# Description
This challenge give us two files. Mem file and pcap file.

# Strategy

1. Use volatility to analyze the mem file and dump any file needed.
2. Hint said "The malware seems trying to establish connection to mothership". So we can try to look at cmdline or pslist.
3. Extract the command that has been run or find any suspicious process to get the next clue.
4. Proceed to analyse the pcap. Try to focus on http/DNS. Since the pcap only has DNS, try to foucs on DNS only.

# Solution

There are two solutions for this challenge.

## First Solution

Just use strings to find the url
![image](https://github.com/user-attachments/assets/e82d9a31-2c8a-4c36-b522-a7aeb55f039a)

Go to "https://pastebin.com/raw/PDXfh5bb" and get the flag.

## Second solution

1. Use the volatility3 to investigate the memory dump given:

Command:
|vol -f memdump.mem windows.pslist

Found a strange process which is crypt.exe:
![image](https://github.com/user-attachments/assets/0e3d83b7-17b3-4a92-9a1a-684031b71701)

2. Proceed with command "windows.cmdline.CmdLine"

Crypt.exe file has been executed by the "Blow" user.
![image](https://github.com/user-attachments/assets/ccf48d50-ae7e-4843-bbf9-84e23f9e9bee)

3. Proceed with dump the "crypt.exe" for further analysis.

![image](https://github.com/user-attachments/assets/7d2a7226-384f-4fa4-be7a-65bb209ee6a9)

The pid is 5200

and we will get all the extracted files:

![image](https://github.com/user-attachments/assets/9466b585-4de6-4f55-ac79-ebaf8765a37c)

Focus on the ".exe.dat" file, this is the executable file

5. Strings that file:

   ![image](https://github.com/user-attachments/assets/c3a4af2d-3563-40bd-a3c5-16997ab4b87b)

   we can see the ".pyd" file extension. Meaning that the file was compiled with the python.
   
7. Use a tool from github called pyintxtractor:
   
https://github.com/extremecoders-re/pyinstxtractor.

This tool will decompile that executable file, so we can read the content

9. After succesfully decomoile it, use an online tool to read the pyc.

    The tool is , pylingual.io
   
11. Analyze and undersatnd  the python code to get some information.

![image](https://github.com/user-attachments/assets/81050d28-3440-40bf-a1cc-253e70a10a05)

we can found the pastebin link, and the flag inside that pastebin link (https://pastebin.com/raw/PDXfh5bb).

WGMY{8b9777c8d7da5b10b65165489302af32}
 
  
